@page "/menudetail/{Id}"
@using AtendimentoMultiTenant.Web.Helpers
@using AtendimentoMultiTenant.Web.ManagementArea.Components.Loading
@using FluentValidation
@layout ConfigDashboardMainLayout
@inherits MenuDetailPage

<MudContainer MaxWidth="MaxWidth.ExtraLarge" Class="mt-10">
    <MudOverlay @bind-Visible="IsBusy" DarkBackground Absolute="false">
        <ChildContent>
            <Loading IsLoading="IsBusy" />
        </ChildContent>
    </MudOverlay>
    <EditForm id="@form" Model="@InputModel" OnValidSubmit="OnValidSubmitAsync" OnInvalidSubmit="OnInvalidSubmit">
        <Morris.Blazor.Validation.Validate />
        <MudCard Class="pa-5" Elevation="4">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">Detalhes do Menu</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudGrid>
                    <MudItem xs="12" sm="12" md="12" lg="12">
                        <MudPaper Class="ps-8 pt-5 pe-8 pb-2" Elevation="4">
                            <MudStack Row="true">
                                <MudTextField Class="mb-5" @bind-Value="InputModel.Name"
                                              Validation="@MenuNameValidator.Validation"
                                              Immediate="true"
                                              Label="Nome do Menu" Required="true" />
                                <MudTextField Class="mb-5" @bind-Value="InputModel.Description"
                                              Immediate="true"
                                              Label="Descrição do Menu" Required="true" />
                            </MudStack>
                            <MudStack Row="true">
                                <MudTextField Class="mb-5" @bind-Value="InputModel.Route"
                                              Label="Rota do Menu" Required="true" />
                                <MudTextField Class="mb-5" @bind-Value="InputModel.IsActive"
                                              Label="Ativo" Required="true" />
                                <MudTextField Class="mb-5" @bind-Value="InputModel.Icone"
                                              Label="Icone do Menu" Required="true" />
                            </MudStack>
                        </MudPaper>
                    </MudItem>
                </MudGrid>
            </MudCardContent>
            <MudCardActions Class="me-2">
                <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary" Class="ml-auto">Salvar</MudButton>
            </MudCardActions>
        </MudCard>
    </EditForm>

</MudContainer>

@code {
    #region Properties

    [Parameter]
    public string? Id { get; set; }

    EditForm form = null!;

    #endregion

    #region Validators

    FormValidatorHelper<string> MenuNameValidator = new FormValidatorHelper<string>(x => x
    .NotEmpty()
    .Length(1, 250));

    #endregion

    #region Methods

    protected override void OnParametersSet()
    {
        MenuId = Guid.Parse(Id!);
        GetDetail();
    }

    protected async void GetDetail()
    {
        await GetMenu(MenuId);
    }

    #endregion
}
